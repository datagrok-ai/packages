---
title: "Scripting for non-developers"
---

```mdx-code-block
import Tabs from '@theme/Tabs';
import TabItem from '@theme/TabItem';
```

This section provides a quick introduction to Datagrok scripting.

## Prerequisites

* Sign up and log in to [public server of Datagrok](https://public.datagrok.ai/).
* Alternatively, set up a [local Datagrok environment](../deploy/docker-compose/docker-compose.mdx).

## Datagrok scripting essentials

This section explains the basic concepts of scripting in Datagrok.
Code examples are provided in **Python** and **R**.

:::tip Pro tip

In Datagrok, JavaScript offers unique benefits compared to traditional 
data science languages like Python or R:

* JavaScript script executes right in your browser, 
  leading to shorter spin-up time and more responsive interaction with user actions.
* Datagrok provides an extensive JavaScript API, 
  giving you detailed control over viewer parameters, 
  access to core Datagrok functions, and other sophisticated capabilities.

For these reasons, we suggest trying JavaScript for advanced scripting in Datagrok.

:::

### How to create a script

You can create a script directly on the platform in two ways:

```mdx-code-block
<Tabs>
<TabItem value="fast" label="Fast way" default>
```

* Open Datagrok (e.g. [public homepage](https://public.datagrok.ai/))
* Select `Functions` icon on the right toolbar.
* Select Datagrok's [Scripts section](https://public.datagrok.ai/scripts).
* Hover over the taskbar on the left side. Toolbox appears.
* Open the **Actions** submenu and create a new script in your preferred language.
![scripts](scripts.png)

```mdx-code-block
</TabItem>
<TabItem value="advanced" label="Advanced way">
```

* Enable extended **Main menu** in the **Window** icon on the right toolbar
* Open **Main manu > Tools > Scripting**.
* Choose the language for the script

```mdx-code-block
</TabItem>
</Tabs>
```

The code editor appears with the code inside.

```mdx-code-block
<Tabs>
<TabItem value="python" label="Python" default>
```

```python
#name: Template
#description: Calculates the number of cells in the table
#language: python
#tags: template, demo
#sample: cars.csv
#input: dataframe table [Data table]
#output: int count [Number of cells in the table]
count = table.shape[0] * table.shape[1]
```

```mdx-code-block
</TabItem>
<TabItem value="r" label="R">
```

```r
#name: Template
#description: Calculates the number of cells in the table
#language: r
#tags: template, demo
#sample: cars.csv
#input: dataframe table [Data table]
#output: int count [Number of cells in the table]
count <- nrow(table) * ncol(table)
```

```mdx-code-block
</TabItem>
</Tabs>
```

Congratulations, you've just written a script in Datagrok!
Let's explore how it works.

### Script header

Each Datagrok script has the **header** that contains **header parameters** \-
special comment strings used by Datagrok to determine script name and language,
pass to the script input parameters, and capture script output.  

The template script has the following ones:

* `# name: Template`: The short name of the script.
* `# description: Calculates the number of cells in the table`: The human-readable description.
* `# language: python`: The script language.
* `# tags: template, demo`: The list of tags used to organize and search scripts.
* `# input: dataframe table [Data table]`: Specification of the input parameter.
   The `table` is the parameter name, and `dataframe` is the parameter type.
   See the [supported parameter types](../datagrok/concepts/functions/func-params-annotation#inputs-and-outputs) for details.
* `# output: int count [Number of cells in the table]`: Specification of the output parameter:
   The `int` variable with the name `count`.

For more details, refer to the [functions parameter annotation](../datagrok/concepts/functions/func-params-annotation).

### Supported Languages

| Language header parameter| Language       |
|--------------------------|----------------|
| r                        | R              |
| python                   | Python         |
| octave                   | Octave         |
| julia                    | Julia          |
| grok                     | Grok Scripting |
| JavaScript               | JavaScript     |

### Input and output parameters

The script header's most important part is the specification of input and output parameters (variables).
Each parameter is specified either as input or output.
Datagrok automatically injects _input_ parameters before the script starts
and captures _output_ parameters when the script finishes.
Currently, there is no way to return variables from the script in the middle of the script processing.

Datagrok supports all standard types of scalar parameters (integer, float, boolean, string)
In addition, Datagrok offers high-level parameters designed to interact with dataframes.
You can pass to the script the whole dataframe, dataframe column, list of columns,
or a binary file.

Find the full list and description of supported parameters in the
[Input and output parameters](../datagrok/concepts/functions/func-params-annotation#inputs-and-outputs) section.

### How to run a script

Let's save the script and see how it works.
The built-in editor has the **Run** button on the top panel.
Press it to run a script. You will see the following window:
![Running the template script](pics/template-script-run.png)

When you run a script, 
Datagrok analyzes header parameters
to create an input form and show the outputs.

Provide a dataframe for the script and press **Ok** to run it.
You can choose an already opened dataframe,
open a dataframe from a file, or retrieve it via SQL query.

After the script finishes, Datagrok collects all output parameters and displays them.
In the provided example, this is a single scalar value shown in the **Variables** panel.
You will see the following output:
![The template script output](pics/template-script-output.png)

:::tip Pro tip

Depending on the metadata associated with the parameters, the editor can be
enriched by [validators](scripting-advanced#parameter-validators), [choices](scripting-advanced#parameter-choices),
and [suggestions](scripting-advanced#parameter-suggestions). Validators, choices, and suggestions are
[functions](../datagrok/concepts/functions/functions.md), that means they can be implemented in different ways 
(db query, script, etc), and reused.

:::

### Running previously saved scripts

To run the previously saved script, find it in the **Scripts** section and execute it.

![Script run example](../uploads/gifs/scripting-visualization.gif "Scripting")

For additional capabilities of the Datagrok script editor, see the
[Working with Datagrok script editor](#working-with-datagrok-script-editor) section.


## Filtering

You can use these fields to filter scripts with [smart search](../explore/search-filter-select/smart-search.md):

| Field       | Description                                                       |
|-------------|-------------------------------------------------------------------|
| ID          |                                                                   |
| name        |                                                                   |
| runs        | list of [FuncCall](../datagrok/concepts/functions/function-call.md) object |
| createdOn   |                                                                   |
| updatedOn   |                                                                   |
| author      | [User](../govern/user.md) object                                  |
| starredBy   | [User](../govern/user.md) object                                  |
| commentedBy | [User](../govern/user.md) object                                  |
| usedBy      | [User](../govern/user.md) object                                  |



## More Datagrok scripting

### Dataframes, scalars, and default values

The template script accepts the **dataframe** as the input parameter.
For [Python](https://www.python.org/) this parameter
is a [Pandas](https://pandas.pydata.org/)
[dataframe](https://pandas.pydata.org/docs/reference/api/pandas.DataFrame.html).
[R](https://www.r-project.org/) supports dataframes natively.

Let's modify it to accept and return both dataframes and scalars.
We copy the original dataframe and add a new ID column to it.
Also, we return the number of rows in the table.

```mdx-code-block
<Tabs>
<TabItem value="python" label="Python" default>
```

```python
#name: DataframeIdDemo
#description: Adding ID column to a dataframe
#language: python
#tags: demo, dataframe
#input: dataframe table [Data table]
#input: string id_column = 'ID' [Name of ID column]
#input: string id_prefix = 'id_' [Prefix for ID column]
#output: dataframe new_table [New table with additional column]
#output: int last_row [number of last row]

new_table = table
l = len(new_table)
new_table[id_column] = [f"{id_prefix}{n:04}" for n in range(l)]
last_row = len(new_table)
```

```mdx-code-block
</TabItem>
<TabItem value="r" label="R">
```

```r
#name: DataframeDemo
#description: Adding a new column to a dataframe
#language: r
#tags: demo, dataframe
#input: dataframe table [Data table]
#input: string id_column = 'ID' [Name of ID column]
#input: string id_prefix = 'id_' [Prefix for ID column]
#output: dataframe new_table [New table with additional column]
#output: int last_row [number of last row]

new_table <- table
new_table[id_column] <- paste0(id_prefix, 1:nrow(new_table))
last_row <- nrow(new_table)
```

```mdx-code-block
</TabItem>
</Tabs>
```

When you run the script, you will see the following dialog:

![DataframeIdDemo input](pics/dataframeiddemo-input.png)

Datagrok created the script UI,
populated default values, and created popups with help text

After running this script, Datagrok automatically opens the new dataframe.
It will contain an additional column **ID** with the generated row ID.

## Enhancing script input view

You may customize the script view using additional GUI-related options.
Most of them are hints to improve the interface for your scripts.
You should list options in curly braces in corresponding header lines.
The order of the hints makes no difference. All options are optional.

### Input captions

You can add an arbitrary caption for an input parameter. 
Proper caption helps the user to understand the meaning of the parameter.

```mdx-code-block
<Tabs>
<TabItem value="input" label="Input" default>
```

```python
# input: double V1 { caption: Initial volume of liquid }
```

```mdx-code-block
</TabItem>
<TabItem value="result" label="Result">
```

![caption-example](caption-example.png)

```mdx-code-block
</TabItem>
</Tabs>
```

### Units

You can add a proper unit label for an input parameter. 
The unit label will appear in the input form next to the input field.

```mdx-code-block
<Tabs>
<TabItem value="input" label="Input" default>
```

```python
# input: double initialTemp { units: °С }
```

```mdx-code-block
</TabItem>
<TabItem value="result" label="Result">
```

![units-example](units-example.png)

```mdx-code-block
</TabItem>
</Tabs>
```

### Adding viewers for output dataframes

You can specify viewers to review output dataframes in a human-friendly way.
Each dataframe parameter may have a list of viewers.
For instance, the following code adds `Scatter plot`
and `Line chart` viewers on the input dataframe.

You may see all available viewers opening 
[demo dataframe](https://public.datagrok.ai/f/Demo.TestJobs.Files.DemoFiles/demog.csv)
and opening the toolbox on the left.

<details>
<summary> Fantastic viewers and where to find them </summary>
<div>

![viewers-toolbox](viewers-toolbox.png)

</div>
</details>

```mdx-code-block
<Tabs>
<TabItem value="input" label="Input">
```

```python
# name: Adding viewer on output dataframe
# language: python
# input: dataframe inputDF
# output: dataframe outputDF { viewer: Line chart | Scatter plot }

outputDF = inputDF
outputDF.name = "DF with linechart"
```

```mdx-code-block
</TabItem>
<TabItem value="result" label="Result">
```

![builtin-viewers](builtin-viewers.png)

```mdx-code-block
</TabItem>
</Tabs>
```

:::tip

The default script view supports viewers for _output_ dataframes only.
You may specify viewers _input_ dataframes using
[Rich function view](scripting-advanced.mdx#using-richfunctionview-input-control)

:::

### Customizing dataframes viewers

Each viewer has a list of customizable properties.
They change how the viewer is rendered and how it behaves.
For instance, you may specify the dataframe column used as the X-axis on the scatter plot.

The list of available properties differs for each type of viewer.
You may right-click on the viewer and select `Properties` item in the context menu.
In the `viewer` option, you can specify any property listed in the opened property panel.
For example, the following code:

* specifies marker type and size for linechart
* enables regression line rendering for scatterplot

:::tip

You should enter the viewer property in camelCase format.
For example, here "Show regression line" property
of the scatterplot becomes `showRegressionLine`.

:::

```mdx-code-block
<Tabs>
<TabItem value="input" label="Input">
```

```python
# name: Viewers customization
# language: python
# input: dataframe tempData
# output: dataframe dummyData { viewer: Line chart(markerType: star, markerSize: 15) | Scatter plot(showRegressionLine: true) }
```

```mdx-code-block
</TabItem>
<TabItem value="result" label="Result">
```

![viewers-customization](viewers-customization.png)

```mdx-code-block
</TabItem>
</Tabs>
```

The [RichFunctionView](scripting-advanced.mdx#using-richfunctionview-input-control)
control allows you to create much more complex

## Working with Datagrok script editor

### How to open and edit a script

To edit an existing script:

* Find it in the [Scripts section](https://public.datagrok.ai/scripts).
* Right-click on the script card. The context menu appears.
* Choose the **Edit** action. Built-in editor with script code opens.

### How to debug a script

Currently, Datagrok has limited debugging capabilities.
All scripts except Javascript are executed in isolated environments,
and the only way of communication between the script and Datagrok is output parameters.

If the script throws an unhandled exception, Datagrok catches it and displays an error popup:

![Exception message from a script](pics/script-exception.png)

Now, there is no convenient way to access regular script output.

For big and complicated scripts, we recommend you develop it locally in your IDE,
and then integrate it into Datagrok.

### How to share a script

At that point, your script is only visible to you.
You can also
make it available to the whole community!

All sharing features are in the **Sharing** dialog.

* To open it, find your script in [Scripts section](https://public.datagrok.ai/scripts) and right-click on it.
* Choose the "Share..." option in the context menu. 
In the dialog, you will see groups and users with their privileges.
* You may edit the list of collaborators and grant or revoke privileges at any moment.

<details>
<summary> Sharing step-by-step </summary>
<div>

![share-demo](sharing.gif)

</div>
</details>

### How to delete a script

* Find your script in [Scripts section](https://public.datagrok.ai/scripts).
* Right-click on it. The context menu opens.
* Choose **Delete** option.

:::caution

This action is irreversible!
Your collaborators will lose access to it, and all historical runs will become inaccessible.

:::
